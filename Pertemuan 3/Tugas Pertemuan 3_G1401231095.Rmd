---
title: "Tugas Pertemuan 3 - Regresi dengan Peubah Lag"
author: "Nika Restu Widya Mujianasta G1401231095"
date: "2025-09-14"
output:  
  html_document:
    theme: yeti
    toc: true
    toc_float: true
  word_document: default
  pdf_document: default
---

# Packages

```{r}
library(dLagM)
library(dynlm)
library(MLmetrics)
library(lmtest)
library(car)
```

# Import Data

```{r}
library(readr)
primary_data <- read_csv("C:/Users/Nika Restu Widya/OneDrive/Documents/Semester 5/MPDW/NewDelhi_Air_quality.csv")
head(primary_data)
```

# Pemilihan Variabel X dan Y

## Jurnal

Pemilihan variabel dalam tugas pertemuan 3 ini didasarkan pada suatu penelitian oleh Wang et al. (2020) yang dipublikasikan dalam ISPRS Archives, yang menunjukkan bahwa konsentrasi partikulat kasar (PM10) memiliki hubungan yang signifikan dengan nilai indeks kualitas udara (Air Quality Index/AQI). Hasil penelitian tersebut menemukan bahwa PM10 berkontribusi cukup besar terhadap variasi AQI, dengan korelasi positif yang kuat.

link jurnal : [https://isprs-archives.copernicus.org/articles/XLII-3-W10/1041/2020]

## Pemilihan Variabel

Indeks Kualitas Udara (AQI) dipilih sebagai variabel dependen (Yt) karena AQI merupakan indikator komprehensif yang mencerminkan kondisi kualitas udara secara keseluruhan di suatu wilayah. Variabel PM10 dipilih sebagai variabel independen (Xt) karena partikulat berdiameter ≤10 mikrometer ini merupakan salah satu polutan dominan yang secara signifikan memengaruhi nilai AQI serta berpotensi menimbulkan dampak kesehatan. Selain itu, variabel Y(t-1) dimasukkan untuk menangkap efek keterkaitan waktu (lag effect), yakni bagaimana kondisi kualitas udara pada periode sebelumnya memengaruhi periode berikutnya.

```{r}
library(dplyr)

data <- primary_data %>%
  mutate(
    t = row_number(),
    Yt = AQI,
    `Y(t-1)` = lag(AQI, 1),
    Xt = pm10
  ) %>%
  select(t, Yt, `Y(t-1)`, Xt)

head(data)

```

# Pembagian Data

Metode pembagian data dengan 80% data sebagai train dan 20% data sebagai test, dengan 72 observasi, penggunaan 58 baris sebagai train cukup besar untuk melatih model agar mampu menangkap pola, sementara 14 baris test masih cukup untuk mengevaluasi performa model.

```{r}
train<-data[1:58,] 
test<-data[59:72,]
```

# Model Koyck

Model Koyck memiliki asumsi yang sangat cerdas: pengaruh dari masa lalu akan semakin melemah seiring berjalannya waktu.

Secara matematis, Koyck menyederhanakan model yang memiliki tak hingga lag menjadi model yang jauh lebih simpel dengan memasukkan lag dari variabel dependen (Yt−1) sebagai salah satu prediktor. Yt−1 ini secara implisit sudah merangkum semua informasi dari lag X di masa lalu.

## Pemodelan

```{r}
model.koyck <- koyckDlm(x = train$Xt, y = train$Yt)
summary(model.koyck)
AIC(model.koyck)
BIC(model.koyck)
```

### Interpretasi Hasil:

-   Dari `summary`, kita dapatkan model:

$$
\hat{Y}_t = -0.2674 + 0.2593 X_t + 0.9204 Y_{t-1}
$$

-   Koefisien $X_t$ (0.2593) signifikan pada taraf 5%, artinya nilai $X$ (PM10) saat ini berpengaruh positif terhadap $Y$ (AQI). Setiap kenaikan 1 satuan PM10 akan meningkatkan AQI sebesar 0.26 satuan.

-   Koefisien $Y_{t-1}$ (0.9204) juga signifikan dengan p-value \< 0.001. Hal ini menunjukkan bahwa sekitar 92% kondisi kualitas udara di periode sebelumnya masih terbawa ke periode saat ini.

-   Nilai $R^2 = 0.8298$ menunjukkan bahwa sekitar 82.9% variasi AQI dapat dijelaskan oleh model. Artinya, model memiliki kemampuan prediksi yang baik.

## Peramalan dan Akurasi

Berikut adalah hasil peramalan y untuk 14 periode kedepan menggunakan model koyck

```{r}
fore.koyck <- forecast(model = model.koyck, x=test$Xt, h=14)
fore.koyck
mape.koyck <- MAPE(fore.koyck$forecasts, test$Yt)
mape.koyck #data test
#akurasi data training
GoF(model.koyck)
```

Model Koyck yang dibangun memiliki akurasi yang sangat baik, ditunjukkan oleh nilai MAPE dan sMAPE yang sangat kecil (0,02566875). Model juga tidak menunjukkan bias yang berarti (MPE ≈ 0), sehingga layak digunakan untuk prediksi AQI.

# Regression with Distributed Lag

**Regression with Distributed Lag (DLM)** adalah model regresi yang digunakan untuk menganalisis hubungan antara suatu variabel dependen dengan variabel independen beserta lag-lagnya.

Dengan kata lain, model ini tidak hanya mempertimbangkan pengaruh variabel penjelas pada periode berjalan, tetapi juga pengaruhnya yang **tertunda (lagged effect)** pada periode berikutnya.

## Pemodelan (Lag=2)

Dengan kata lain, model ini tidak hanya mempertimbangkan pengaruh variabel penjelas pada periode berjalan, tetapi juga pengaruhnya yang **tertunda (lagged effect)** pada periode berikutnya.

```{r}
model.dlm <- dlm(x = train$Xt,y = train$Yt , q = 2)
summary(model.dlm)
AIC(model.dlm)
BIC(model.dlm)
```

### Interpretasi Hasil

Hasil estimasi model Distributed Lag dengan $q=2$ diperoleh persamaan regresi sebagai berikut:

$$
Y_t = 22.1626 + 0.1392X_t - 0.5419X_{t-1} + 0.9502X_{t-2} + e_t
$$

Berdasarkan output model, koefisien intersep signifikan pada taraf nyata 1% ($p < 0.001$). Namun, variabel $X_t$, $X_{t-1}$, dan $X_{t-2}$ tidak signifikan dengan nilai $p$ masing-masing 0.824, 0.592, dan 0.128.

Nilai koefisien determinasi ($R^2$) sebesar 0.135 dan adjusted-$R^2$ sebesar 0.085, yang menunjukkan bahwa hanya sekitar 8.5% variasi $Y_t$ dapat dijelaskan oleh model. Nilai AIC dan BIC yang diperoleh masing-masing sebesar 248.46 dan 258.59, relatif lebih tinggi dibandingkan model Koyck.

Dengan demikian, model Distributed Lag dengan $q=2$ kurang baik dalam menjelaskan variasi AQI.

## Pemodelan dan Akurasi

```{r}
fore.dlm <- forecast(model = model.dlm, x=test$Xt, h=14)
fore.dlm
mape.dlm <- MAPE(fore.dlm$forecasts, test$Yt)
mape.dlm
#akurasi data training
GoF(model.dlm)
```

Model Distributed Lag dengan q=2 **kurang baik** untuk memprediksi AQI. Walaupun pada data training masih menghasilkan MAPE sekitar 5.7% (cukup baik), namun pada data testing akurasinya menurun drastis menjadi 23.8%. Dibandingkan dengan model Koyck sebelumnya.

## *Lag* Optimum

Daripada menebak, kita bisa meminta R untuk mencari panjang lag yang paling optimal berdasarkan kriteria informasi seperti **AIC (Akaike Information Criterion)**. AIC menyeimbangkan antara kecocokan model dengan kompleksitasnya.

```{r}
#penentuan lag optimum 
finiteDLMauto(formula = Yt ~ Xt,
              data = data.frame(train), q.min = 1, q.max = 10,
              model.type = "dlm", error.type = "AIC", trace = TRUE)
```

Berdasarkan output, **lag optimum diperoleh pada q = 10** karena menghasilkan nilai AIC, BIC, dan MASE yang paling kecil dibandingkan lag lainnya.

```{r}
#model dlm dengan lag optimum
model.dlm2 <- dlm(x = train$Xt,y = train$Yt , q = 10)
summary(model.dlm2)
AIC(model.dlm2)
BIC(model.dlm2)
```

Model dengan lag 10 ini secara keseluruhan **cukup baik** (signifikan secara simultan dengan R² moderat), tetapi **tidak ada lag individu yang signifikan**. AIC dan BIC yang relatif rendah dibandingkan dengan lag lain mendukung bahwa **lag 10 adalah model optimum**.

Adapun hasil peramalan 14 periode kedepan menggunakan model tersebut adalah sebagai berikut

```{r}
#peramalan dan akurasi
fore.dlm2 <- forecast(model = model.dlm2, x=test$Xt, h=14)

#akurasi data test
mape.dlm2<- MAPE(fore.dlm2$forecasts, test$Yt)
mape.dlm2

#akurasi data training
GoF(model.dlm2)
```

Model Distributed Lag dengan lag 2 yang mampu menjelaskan data training dengan (MAPE 3,8%). Namun, saat diaplikasikan pada data test, tingkat akurasi menurun menjadi 20,9%.

Perbedaan ini menunjukkan bahwa meskipun model cukup stabil, ada indikasi bahwa pola baru pada data uji tidak sepenuhnya ditangkap oleh model, sehingga mungkin perlu dibandingkan dengan model Koyck dan AR untuk melihat mana yang lebih konsisten.

# Model Autoregressive

ARDL adalah model "hibrida" yang paling lengkap. Ia menggabungkan dua ide:

1.  **Distributed Lag (DL):** $Y_t$ dipengaruhi oleh nilai X di masa lalu $(X_{t−1},X_{t−2},\dots)$.

2.  **Autoregressive (AR):** Y_t juga dipengaruhi oleh nilainya sendiri di masa lalu $(Y_{t−1},Y_{t−2},\dots)$. Ini menangkap adanya "momentum" atau "inersia" dalam data.

Model ini sangat populer dalam ekonometrika. Kita menyebutnya model **ARDL(p, q)**, di mana `p` adalah jumlah lag untuk Y dan `q` adalah jumlah lag untuk X.

## Pemodelan

Pemodelan Autoregressive dilakukan menggunakan fungsi `dLagM::ardlDlm()` . Fungsi tersebut akan menerapkan *autoregressive* berordo $(p,q)$ dengan satu prediktor. Fungsi umum dari `ardlDlm()` adalah sebagai berikut.

Dengan $p$ adalah integer yang mewakili panjang *lag* yang terbatas dan $q$ adalah integer yang merepresentasikan ordo dari proses *autoregressive*.

```{r}
model.ardl <- ardlDlm(x = train$Xt, y = train$Yt, p = 1 , q = 1)
summary(model.ardl)
AIC(model.ardl)
BIC(model.ardl)
```

Berdasarkan hasil estimasi model autoregressive distributed lag (ADL), diperoleh persamaan sebagai berikut:

$$
Y_t = 0.3141 + 0.0973X_t + 0.1382X_{t-1} + 0.9066Y_{t-1} + \varepsilon_t
$$

Hasil estimasi menunjukkan bahwa koefisien variabel $X_t$ (0.0973) dan $X_{t-1}$ (0.1382) tidak signifikan secara statistik, dengan nilai p-value masing-masing 0.587 dan 0.439. Hal ini mengindikasikan bahwa variabel bebas $X$ pada periode saat ini maupun sebelumnya tidak berpengaruh nyata terhadap variabel dependen $Y$. Sebaliknya, koefisien $Y_{t-1}$ sebesar 0.9066 signifikan pada taraf 1% (p-value $< 0.001$), yang berarti bahwa nilai $Y$ pada periode sebelumnya memiliki pengaruh sangat kuat terhadap nilai $Y$ pada periode sekarang.

Kebaikan model dapat dilihat dari nilai koefisien determinasi $R^2 = 0.8324$ dan adjusted-$R^2 = 0.823$, yang menunjukkan bahwa sekitar 83% variasi $Y$ dapat dijelaskan oleh model.

## Peramalan dan Akurasi

Berikut hasil peramalan untuk 5 periode ke depan menggunakan Model Autoregressive dengan $p=1$ dan $q=1$.

```{r}
# Forecast ke depan h = 14 periode
data.test <- data.frame(Xt = test$Xt)
fore.ardl <- forecast(model = model.ardl, x = data.test$Xt, h = 14)
fore.ardl

# Akurasi data test
mape.ardl <- MAPE(fore.ardl$forecasts, test$Yt)
mape.ardl

# Akurasi data training
GoF(model.ardl)

```

Model **ARDL dengan lag p = 1 dan q = 1** berhasil diestimasi dengan baik dan digunakan untuk meramalkan 14 periode ke depan. Nilai hasil peramalan menunjukkan pola yang relatif meningkat secara bertahap, dimulai dari 23,03 pada periode pertama hingga mencapai 27,92 pada periode ke-14. Hal ini mengindikasikan adanya kecenderungan peningkatan variabel dependen yang dipengaruhi baik oleh nilai sebelumnya maupun oleh variabel independen yang digunakan dalam model.

Dari sisi evaluasi performa, model menghasilkan **Mean Absolute Error (MAE) sebesar 0,6875**, yang berarti rata-rata deviasi absolut prediksi terhadap data aktual kurang dari 1 satuan. Nilai **Mean Percentage Error (MPE) sebesar –0,0011** mendekati nol, sehingga model tidak cenderung melakukan overestimate maupun underestimate secara konsisten. Sementara itu, **Mean Absolute Percentage Error (MAPE) sebesar 2,57%** dan **symmetric MAPE (sMAPE) sebesar 2,56%** mengindikasikan tingkat kesalahan relatif yang sangat rendah (di bawah 10%), sehingga model dapat dikategorikan **sangat akurat** untuk peramalan.

## *Lag* Optimum

```{r}
#penentuan lag optimum
model.ardl.opt <- ardlBoundOrders(data = data.frame(data), ic = "AIC", 
                                  formula = Yt ~ Xt )
model.ardl.opt
min_p=c()
for(i in 1:6){
  min_p[i]=min(model.ardl.opt$Stat.table[[i]])
}
q_opt=which(min_p==min(min_p, na.rm = TRUE))
p_opt=which(model.ardl.opt$Stat.table[[q_opt]] == 
              min(model.ardl.opt$Stat.table[[q_opt]], na.rm = TRUE))
data.frame("q_optimum" = q_opt, "p_optimum" = p_opt, 
           "AIC"=model.ardl.opt$min.Stat)
```

Berdasarkan hasil pemilihan orde lag menggunakan kriteria informasi Akaike Information Criterion (AIC), diperoleh bahwa kombinasi lag dengan nilai AIC terkecil adalah pada **p = 13** dan **q = 1**. Nilai AIC yang lebih kecil menunjukkan bahwa model tersebut mampu memberikan keseimbangan terbaik antara tingkat kesesuaian (goodness of fit) dan kompleksitas model. Dengan demikian, ARDL(13,1) dipilih sebagai model optimum karena lebih efisien dibandingkan kombinasi lag lainnya.

```{r}
model.ardl2 <- ardlDlm(formula = Yt ~ Xt, 
                         data = train,p = 13, q = 1)
summary(model.ardl2)
```

Hasil estimasi model ARDL dengan orde lag \$p = 13\$ untuk variabel independen \$X_t\$ dan \$q = 1\$ untuk variabel dependen \$Y_t\$ menunjukkan bahwa model memiliki nilai \\textit{Adjusted R-squared} sebesar 0,8928. Hal ini berarti sekitar 89,28\\% variasi dalam \$Y_t\$ dapat dijelaskan oleh variabel independen dan nilai historis \$Y_t\$ pada periode sebelumnya, sedangkan sisanya dijelaskan oleh faktor lain di luar model. Koefisien variabel \$Y\_{t-1}\$ sebesar 0,8582 signifikan pada taraf 1\\% (\$p \< 0,01\$). Temuan ini mengindikasikan adanya ketergantungan yang kuat dari periode sebelumnya terhadap nilai \$Y_t\$ saat ini, sesuai dengan karakteristik data deret waktu. Sebagian besar lag dari variabel \$X_t\$ tidak signifikan secara statistik.

# Pemodelan DLM & ARDL dengan Library `dynlm`

Pemodelan regresi dengan peubah *lag* tidak hanya dapat dilakukan dengan fungsi pada *packages* `dLagM` , tetapi terdapat *packages* `dynlm` yang dapat digunakan. Fungsi `dynlm` secara umum adalah sebagai berikut.

Untuk menentukan `formula` model yang akan digunakan, tersedia fungsi tambahan yang memungkinkan spesifikasi dinamika (melalui `d()` dan `L()`) atau pola linier/siklus dengan mudah (melalui `trend()`, `season()`, dan `harmon()`). Semua fungsi formula baru mengharuskan argumennya berupa objek deret waktu (yaitu, `"ts"` atau `"zoo"`).

```{r}
#data time series
train.ts<-ts(train)
test.ts<-ts(test)
data.ts<-ts(data)
```

```{r}
#sama dengan model dlm q=1
cons_lm1 <- dynlm(Yt ~ Xt+L(Xt),data = train.ts)
#sama dengan model ardl p=1 q=0
cons_lm2 <- dynlm(Yt ~ Xt+L(Yt),data = train.ts)
#sama dengan ardl p=1 q=1
cons_lm3 <- dynlm(Yt ~ Xt+L(Xt)+L(Yt),data = train.ts)
#sama dengan dlm p=2
cons_lm4 <- dynlm(Yt ~ Xt+L(Xt)+L(Xt,2),data = train.ts)

```

## Ringkasan Model

```{r}
summary(cons_lm1)
summary(cons_lm2)
summary(cons_lm3)
summary(cons_lm4)
```

#### Hasil Estimasi Model

##### 1. Distributed Lag Model (DLm) dengan q=1

Persamaan estimasi adalah: $$
Y_t = 24.40 - 0.59 X_t + 0.89 X_{t-1} + \varepsilon_t
$$

Koefisien $X_{t-1}$ signifikan pada taraf 5% ($p=0.0272$), sedangkan $X_t$ tidak signifikan. Nilai $R^2=0.0969$ menunjukkan kemampuan penjelasan model masih rendah. Artinya, pengaruh utama berasal dari lag variabel $X$, bukan nilai saat ini.

------------------------------------------------------------------------

##### 2. ARDL (1,0)

Persamaan estimasi adalah: $$
Y_t = 0.14 + 0.22 X_t + 0.92 Y_{t-1} + \varepsilon_t
$$

Koefisien $X_t$ signifikan pada taraf 5% ($p=0.0219$), dan lag dari $Y_{t-1}$ sangat signifikan ($p<0.001$). Nilai $R^2=0.8305$ menunjukkan model memiliki daya jelaskan yang sangat baik.

------------------------------------------------------------------------

##### 3. ARDL (1,1)

Persamaan estimasi adalah: $$
Y_t = 0.31 + 0.10 X_t + 0.14 X_{t-1} + 0.91 Y_{t-1} + \varepsilon_t
$$

Hanya $Y_{t-1}$ yang signifikan ($p<0.001$), sedangkan $X_t$ dan $X_{t-1}$ tidak signifikan. Nilai $R^2=0.8324$ sedikit lebih tinggi daripada ARDL (1,0), tetapi tambahan lag $X$ tidak meningkatkan signifikansi model.

------------------------------------------------------------------------

##### 4. Distributed Lag Model (DLm) dengan q=2

Persamaan estimasi adalah: $$
Y_t = 22.16 + 0.14 X_t - 0.54 X_{t-1} + 0.95 X_{t-2} + \varepsilon_t
$$

Tidak ada koefisien $X$ yang signifikan secara statistik. Nilai $R^2=0.135$ masih rendah, sehingga model kurang mampu menjelaskan variasi $Y_t$.

------------------------------------------------------------------------

##### Kesimpulan

Model **ARDL (1,0)** merupakan model terbaik karena memiliki nilai $R^2$ tertinggi (83%) dan semua variabel signifikan pada taraf 5%. Hal ini menunjukkan bahwa nilai $Y_t$ sangat dipengaruhi oleh nilai masa lalunya ($Y_{t-1}$) dan juga dipengaruhi secara signifikan oleh nilai $X_t$.

## SSE

```{r}
deviance(cons_lm1)
deviance(cons_lm2)
deviance(cons_lm3)
deviance(cons_lm4)
```

Model dengan deviance paling kecil adalah **ARDL (1,1)**, sehingga secara goodness-of-fit model ini lebih unggul dibandingkan model lain. Namun, jika melihat signifikansi parameter, model **ARDL (1,0)** bisa lebih layak dipilih karena semua koefisien signifikan dan deviance-nya sudah cukup rendah.

## Uji Diagnostik

```{r}
#uji model
if(require("lmtest")) encomptest(cons_lm1, cons_lm2)
```

Hasil uji:

-   $M_1$ vs $M_E$: $F = 232.65$, $p < 0.001$ ⟶ **Model E lebih baik dibanding M1**.\
-   $M_2$ vs $M_E$: $F = 0.61$, $p = 0.439$ ⟶ **Model E tidak lebih baik dari M2**.

**Kesimpulan:** Model $M_2$ ($Y_t \sim X_t + L(Y_t)$) adalah model paling memadai, karena tambahan $L(X_t)$ tidak memberikan perbaikan signifikan.

### Autokorelasi

```{r}
#durbin watson
dwtest(cons_lm1)
dwtest(cons_lm2)
dwtest(cons_lm3)
dwtest(cons_lm4)
```

Statistik Durbin–Watson (DW) menguji autokorelasi residual dengan hipotesis:

$$
H_0 : \rho = 0 \quad (\text{tidak ada autokorelasi})
$$ $$
H_1 : \rho > 0 \quad (\text{ada autokorelasi positif})
$$

Hasil uji:

-   **Model 1**: $DW = 0.233$, $p < 0.001$ ⟶ terdapat autokorelasi positif kuat.\
-   **Model 2**: $DW = 1.070$, $p < 0.001$ ⟶ terdapat autokorelasi positif.\
-   **Model 3**: $DW = 1.072$, $p < 0.001$ ⟶ terdapat autokorelasi positif.\
-   **Model 4**: $DW = 0.180$, $p < 0.001$ ⟶ terdapat autokorelasi positif sangat kuat.

**Kesimpulan:** Semua model mengalami autokorelasi positif pada residualnya, ditunjukkan oleh nilai $DW < 2$ dan $p < 0.05$.

### Heterogenitas

```{r}
bptest(cons_lm1)
bptest(cons_lm2)
bptest(cons_lm3)
bptest(cons_lm4)
```

Hipotesis:

$$
H_0 : \text{Var}(\varepsilon_i) = \sigma^2 \quad (\text{homoskedastis})
$$ $$
H_1 : \text{Var}(\varepsilon_i) \neq \sigma^2 \quad (\text{heteroskedastis})
$$

Hasil uji:

-   **Model 1**: $BP = 2.498$, $p = 0.287 > 0.05$ ⟶ tidak ada bukti heteroskedastisitas.\
-   **Model 2**: $BP = 3.575$, $p = 0.167 > 0.05$ ⟶ tidak ada bukti heteroskedastisitas.\
-   **Model 3**: $BP = 3.448$, $p = 0.328 > 0.05$ ⟶ tidak ada bukti heteroskedastisitas.\
-   **Model 4**: $BP = 3.330$, $p = 0.344 > 0.05$ ⟶ tidak ada bukti heteroskedastisitas.

**Kesimpulan:** Semua model memenuhi asumsi homoskedastisitas karena nilai $p > 0.05$.

### Kenormalan 

```{r}
shapiro.test(residuals(cons_lm1))
shapiro.test(residuals(cons_lm2))
shapiro.test(residuals(cons_lm3))
shapiro.test(residuals(cons_lm4))
```

Hipotesis:

$$
H_0 : \varepsilon \sim N(0, \sigma^2) \quad (\text{residual berdistribusi normal})
$$\
$$
H_1 : \varepsilon \not\sim N(0, \sigma^2) \quad (\text{residual tidak normal})
$$

Hasil uji:

-   **Model 1**: $W = 0.976$, $p = 0.326 > 0.05$ ⟶ residual berdistribusi normal.\
-   **Model 2**: $W = 0.969$, $p = 0.153 > 0.05$ ⟶ residual berdistribusi normal.\
-   **Model 3**: $W = 0.967$, $p = 0.119 > 0.05$ ⟶ residual berdistribusi normal.\
-   **Model 4**: $W = 0.972$, $p = 0.223 > 0.05$ ⟶ residual berdistribusi normal.

**Kesimpulan:** Semua model memenuhi asumsi normalitas karena nilai $p > 0.05$.

# Perbandingan Model

```{r}
akurasi <- matrix(c(mape.koyck, mape.dlm, mape.dlm2, mape.ardl))
row.names(akurasi)<- c("Koyck","DLM 1","DLM 2","Autoregressive")
colnames(akurasi) <- c("MAPE")
akurasi
```

Semakin kecil nilai MAPE, semakin baik kinerja model dalam meramalkan data.\
Berdasarkan hasil di atas, **model Koyck** menghasilkan akurasi terbaik (MAPE terendah = 0.104), diikuti oleh **model Autoregressive** (MAPE = 0.108). Sementara itu, **DLM(1)** dan **DLM(2)** memiliki tingkat kesalahan relatif lebih tinggi sehingga kurang optimal dibandingkan dua model sebelumnya.

## Plot

```{r}
par(mfrow=c(1,1))
plot(test$Xt, test$Yt, type="b", col="black", ylim=c(20,40))
points(test$Xt, fore.koyck$forecasts,col="red")
lines(test$Xt, fore.koyck$forecasts,col="red")
points(test$Xt, fore.dlm$forecasts,col="blue")
lines(test$Xt, fore.dlm$forecasts,col="blue")
points(test$Xt, fore.dlm2$forecasts,col="orange")
lines(test$Xt, fore.dlm2$forecasts,col="orange")
points(test$Xt, fore.ardl$forecasts,col="green")
lines(test$Xt, fore.ardl$forecasts,col="green")
legend("topleft",c("aktual", "koyck","DLM 1","DLM 2", "autoregressive"), lty=1, col=c("black","red","blue","orange","green"), cex=0.8)

```

Berdasarkan plot tersebut, terlihat bahwa plot yang paling mendekati data aktualnya adalah Model koyck, sehingga dapat disimpulkan model terbaik dalam hal ini adalah model regresi koyck.

-SELESAI-
