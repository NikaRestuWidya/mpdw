---
title: "Tugas Pertemuan 2"
author: "Nika Restu Widya Mujianasta G1401231095"
date: "2025-09-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Library

```{r}
library(lmtest) # Untuk Uji Durbin-Watson
library(orcutt) # Untuk metode Cochrane-Orcutt
library(HoRM)   # Untuk metode Hildreth-Lu
```

# 1.Data IPM Provinsi Jawa TIMUR

```{r}
# Membuat data IPM 2015-2024
tahun <- c(2010, 2011, 2012, 2013, 2014, 
           2015, 2016, 2017, 2018, 2019, 
           2020, 2021, 2022, 2023, 2024)

ipm <- c(65.36, 66.06, 66.74, 67.55, 68.14, 
         68.95, 69.74, 70.27, 70.77, 71.50, 
         71.71, 72.14, 72.75, 73.38, 74.09)

# Membuat data frame
ipm_jatim <- data.frame(tahun = tahun, ipm = ipm)

# Menampilkan data
print(ipm_jatim)
```

# 2. Membuat Model Awal (Tersangka Utama)

```{r}
# Membuat model regresi OLS
model_awal <- lm(ipm ~ tahun, data = ipm_jatim)
summary(model_awal)
```

Observasi Awal : Nilai Adjusted R-squared sangat tinggi (0.9919) menandakan bahwa model mampu menjelaskan 99,19% variasi IPM hanya dengan variabel tahun, sehingga model ini sangat baik dalam menggambarkan tren pertumbuhan IPM. Uji signifikansi juga menunjukkan bahwa variabel tahun berpengaruh signifikan terhadap IPM dengan nilai ð‘\< 0,001

# 3. Diagnosis (Investigasi Sisaan)

## 3.1. Diagnosis Visual

```{r}
# Mengambil sisaan
sisaan_awal <- residuals(model_awal)

# Plot sisaan terhadap waktu
plot(ipm_jatim$tahun, sisaan_awal, type = "o", pch = 20, col = "red",
     main = "Plot Sisaan vs Waktu", xlab = "Tahun", ylab = "Sisaan")
abline(h = 0, lty = 2)
```

Sisaan tidak tersebar acak di sekitar garis nol. Terlihat ada pola naik (2010â€“2016), kemudian turun (2017â€“2021), lalu naik sedikit lagi setelah 2022.

## 3.2. Diagnosis Formal (Uji Durbin-Watson)

Visual saja tidak cukup, kita butuh bukti formal. Kita gunakan Uji Durbin-Watson.

-   **H0 (Hipotesis Nol)**: Tidak ada autokorelasi. Sisaan saling bebas.

-   **H1 (Hipotesis Alternatif)**: Ada autokorelasi.

```{r}
dwtest(model_awal)
```

**Hasil Investigasi:**

-   P-value yang dihasilkan **sangat kecil (3.91e-06)**, yaitu di bawah tingkat signifikansi 0.05.

-   Kesimpulan: Kita **menolak H0**. Bukti sudah kuat. Hasil uji Durbin-Watson menunjukkan ada **autokorelasi positif yang kuat dan signifikan** pada sisaan model regresi linear sederhana IPM terhadap tahun.

# 4. Penanganan 

### Metode 1: Cochrane-Orcutt

```{r}
model_co <- cochrane.orcutt(model_awal)
summary(model_co)

# rho paling optimum
rho <- model_co$rho
cat("Rho optimum:", rho)
```

-    **Durbin-Watson (transformed) = 1.83**, p = 0.255\
    â†’ Nilai ini sudah mendekati 2, dan **p-value \> 0.05**, artinya **tidak ada lagi bukti autokorelasi**.

-    **Rho optimum = 0.7368**\
    â†’ menunjukkan adanya korelasi kuat antar sisaan pada model awal, yang kemudian diperhitungkan oleh metode koreksi.

```{r}
# Verifikasi Manual
ipm.trans <- ipm_jatim$ipm[-1] - ipm_jatim$ipm[-12]*rho

tahun.trans <- ipm_jatim$tahun[-1] - ipm_jatim$tahun[-12]*rho
model_co_manual <- lm(ipm.trans~tahun.trans)

b0_co_manual <- coef(model_co_manual)[1]/(1-rho)
b1_co_manual <- coef(model_co_manual)[2]
cat("Koefisien manual Cochrane-Orcutt:\n")
cat("b0:", b0_co_manual, "\n")
cat("b1:", b1_co_manual, "\n")
```

### Metode 2: Hildreth-Lu

```{r}
#Penanganan Autokorelasi Hildreth lu
# Hildreth-Lu
hildreth.lu.func<- function(r, model){
  x <- model.matrix(model)[,-1]
  y <- model.response(model.frame(model))
  n <- length(y)
  t <- 2:n
  y <- y[t]-r*y[t-1]
  x <- x[t]-r*x[t-1]
  
  return(lm(y~x))
}

#Pencariab rho yang meminimumkan SSE
r <- c(seq(0.1,0.9, by= 0.1))
tab <- data.frame("rho" = r, "SSE" = sapply(r, function(i){deviance(hildreth.lu.func(i, model_awal))}))
round(tab, 4)
```

```{r}
#Rho optimal di sekitar 0.4
rOpt <- seq(0.2,0.8, by= 0.001)
tabOpt <- data.frame("rho" = rOpt, "SSE" = sapply(rOpt, function(i){deviance(hildreth.lu.func(i, model_awal))}))
head(tabOpt[order(tabOpt$SSE),])
```

```{r}
#Grafik SSE optimum
par(mfrow = c(1,1))
plot(tab$SSE ~ tab$rho , type = "l", xlab = "Rho", ylab = "SSE")
abline(v = tabOpt[tabOpt$SSE==min(tabOpt$SSE),"rho"], lty = 2, col="red",lwd=2)
text(x=0.737, y=0.2543887, labels = "rho=0.737", cex = 0.8)
```

```{r}
model_hl <- hildreth.lu(ipm_jatim$ipm, ipm_jatim$tahun, rho = 0.737)
summary(model_hl)
```

```{r}
#Transformasi Balik
cat("y = ", coef(model_hl)[1]/(1-0.341), "+", coef(model_hl)[2],"x", sep = "")
```

```{r}
#Deteksi autokorelasi
dwtest(model_hl)
```
Hasil summary memberikan model akhir yang juga sudah "sehat", dengan statistik D-W yang sudah membaik.

# 5. Evaluasi Akhir
```{r}
# Menghitung SSE untuk setiap model secara manual
sse_awal <- sum(residuals(model_awal)^2)
sse_co <- sum(residuals(model_co)^2)
sse_hl <- sum(residuals(model_hl)^2)

# Membuat tabel perbandingan
data.frame(
  Metode = c("Model Awal (Sakit)", "Cochrane-Orcutt (Sehat)", "Hildreth-Lu (Sehat)"),
  SSE = c(sse_awal, sse_co, sse_hl),
  DW_Statistic = c(dwtest(model_awal)$statistic, model_co$DW[3], dwtest(model_hl)$statistic)
)
```

Berdasarkan hasil analisis, model awal memiliki nilai SSE yang relatif kecil namun menunjukkan adanya autokorelasi positif yang kuat dengan nilai DW Statistic jauh di bawah 2, sehingga model dikategorikan â€œsakitâ€. Metode Cochrane-Orcutt mampu memperbaiki masalah autokorelasi dengan nilai DW mendekati 2, meskipun harus mengorbankan peningkatan error (SSE lebih besar). Sementara itu, metode Hildreth-Lu menghasilkan SSE paling kecil sehingga model lebih fit terhadap data, namun nilai DW masih di bawah 2 yang mengindikasikan autokorelasi belum sepenuhnya hilang. Dengan demikian, Cochrane-Orcutt lebih unggul dalam mengatasi autokorelasi, sedangkan Hildreth-Lu lebih unggul dalam meminimalkan error.

**Kesimpulan Investigasi:**

-   Baik metode Cochrane-Orcutt maupun Hildreth-Lu berhasil menurunkan SSE model, artinya model yang baru lebih akurat.

-   Keduanya juga berhasil menghilangkan autokorelasi, yang ditunjukkan oleh statistik D-W yang mendekati 2.


